<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title><%= htmlWebpackPlugin.options.title %></title>
  </head>
  <body onload="load()">
    <div style="position: fixed; right: 0; top: 0.3em">
      <iframe
        src="https://ghbtns.com/github-btn.html?user=myliang&repo=x-spreadsheet&type=star&count=true&size=large"
        frameborder="0"
        scrolling="0"
        width="160px"
        height="30px"
      ></iframe>
    </div>
    <div id="x-spreadsheet-demo"></div>
    <script>
      function load() {
        const rows10 = { len: 1000 };
        for (let i = 0; i < 1000; i += 1) {
          rows10[i] = {
            cells: {
              0: { text: "A-" + i },
              1: { text: "B-" + i },
              2: { text: "C-" + i },
              3: { text: "D-" + i },
              4: { text: "E-" + i },
              5: { text: "F-" + i },
            },
          };
        }
        const rows = {
          0: {
            cells: [
              {
                text: "",
              },
              {
                text: "Base Year",
              },
              {
                text: "1",
              },
              {
                text: "2",
              },
              {
                text: "3",
              },
              {
                text: "4",
              },
              {
                text: "5",
              },
              {
                text: "6",
              },
              {
                text: "7",
              },
              {
                text: "8",
              },
              {
                text: "9",
              },
              {
                text: "10",
              },
              {
                text: "Terminal Year",
              },
            ],
          },
          1: {
            cells: [
              {
                text: "Revenues",
              },
              {
                text: 1000,
              },
              {
                text: "=B2*1+0.25",
              },
              {
                text: "=C2*1+0.25",
              },
              {
                text: "=D2*1+0.25",
              },
              {
                text: "=E2*1+0.25",
              },
              {
                text: "=F2*1+0.25",
              },
              {
                text: "=G2*1+0.25 - 0.25-0.1 / 5",
              },
              {
                text: "=H2*1+0.25 - 0.25-0.1 / 5 * 2",
              },
              {
                text: "=I2*1+0.25 - 0.25-0.1 / 5 * 3",
              },
              {
                text: "=J2*1+0.25 - 0.25-0.1 / 5 * 4",
              },
              {
                text: "=K2*1+0.25 - 0.25-0.1 / 5 * 5",
              },
              {
                text: "=L2*1+0.1",
              },
            ],
          },
          2: {
            cells: [
              {
                text: "Operating Margin",
              },
              {
                text: "=B4/B2",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=L3",
              },
            ],
          },
          3: {
            cells: [
              {
                text: "Operating Income",
              },
              {
                text: "=33",
              },
              {
                text: "=C3*C2",
              },
              {
                text: "=D3*D2",
              },
              {
                text: "=E3*E2",
              },
              {
                text: "=F3*F2",
              },
              {
                text: "=G3*G2",
              },
              {
                text: "=H3*H2",
              },
              {
                text: "=I3*I2",
              },
              {
                text: "=J3*J2",
              },
              {
                text: "=K3*K2",
              },
              {
                text: "=L3*L2",
              },
              {
                text: "=M3*M2",
              },
            ],
          },
          4: {
            cells: [
              {
                text: "Tax Rate",
              },
              {
                text: "=0.2",
              },
              {
                text: "=B5",
              },
              {
                text: "=C5",
              },
              {
                text: "=D5",
              },
              {
                text: "=E5",
              },
              {
                text: "=F5",
              },
              {
                text: "=G5+(M5-G5)/5",
              },
              {
                text: "=H5+(M5-G5)/5",
              },
              {
                text: "=I5+(M5-G5)/5",
              },
              {
                text: "=J5+(M5-G5)/5",
              },
              {
                text: "=K5+(M5-G5)/5",
              },
              {
                text: "=0.2",
              },
            ],
          },
          5: {
            cells: [
              {
                text: "NOPAT",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=M4*(1-M5)",
              },
            ],
          },
          6: {
            cells: [
              {
                text: "- Reinvestment",
              },
              {
                text: "",
              },
              {
                text: "=1",
              },
              {
                text: "=(D2-C2)/D15",
              },
              {
                text: "=(E2-D2)/E15",
              },
              {
                text: "=(F2-E2)/F15",
              },
              {
                text: "=(G2-F2)/G15",
              },
              {
                text: "=(H2-G2)/H15",
              },
              {
                text: "=(I2-H2)/I15",
              },
              {
                text: "=(J2-I2)/J15",
              },
              {
                text: "=(K2-J2)/K15",
              },
              {
                text: "=(L2-K2)/L15",
              },
              {
                text: "=2",
              },
            ],
          },
          7: {
            cells: [
              {
                text: "FCFF",
              },
              {
                text: "",
              },
              {
                text: "=C6 - C7",
              },
              {
                text: "=D6 - D7",
              },
              {
                text: "=E6 - E7",
              },
              {
                text: "=F6 - F7",
              },
              {
                text: "=G6 - G7",
              },
              {
                text: "=H6 - H7",
              },
              {
                text: "=I6 - I7",
              },
              {
                text: "=J6 - J7",
              },
              {
                text: "=K6 - K7",
              },
              {
                text: "=L6 - L7",
              },
              {
                text: "=M6 - M7",
              },
            ],
          },
          8: {
            cells: [
              {
                text: "NOL",
              },
              {
                text: "=0.1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
              {
                text: "=1",
              },
            ],
          },
          9: {
            cells: [
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
            ],
          },
          10: {
            cells: [
              {
                text: "Cost of Capital",
              },
              {
                text: "",
              },
              {
                text: "=0.08",
              },
              {
                text: "=C11",
              },
              {
                text: "=D11",
              },
              {
                text: "=E11",
              },
              {
                text: "=F11",
              },
              {
                text: "=G11-(G11-M11)/5",
              },
              {
                text: "=H11-(G11-M11)/5",
              },
              {
                text: "=I11-(G11-M11)/5",
              },
              {
                text: "=J11-(G11-M11)/5",
              },
              {
                text: "=K11-(G11-M11)/5",
              },
              {
                text: "=0.1 + 0.1",
              },
            ],
          },
          11: {
            cells: [
              {
                text: "Cumulated Discount Factor",
              },
              {
                text: "",
              },
              {
                text: "=1/(1+C11)",
              },
              {
                text: "=C12*(1/(1+D11))",
              },
              {
                text: "=D12*(1/(1+E11))",
              },
              {
                text: "=E12*(1/(1+F11))",
              },
              {
                text: "=F12*(1/(1+G11))",
              },
              {
                text: "=G12*(1/(1+H11))",
              },
              {
                text: "=H12*(1/(1+I11))",
              },
              {
                text: "=I12*(1/(1+J11))",
              },
              {
                text: "=J12*(1/(1+K11))",
              },
              {
                text: "=K12*(1/(1+L11))",
              },
              {
                text: "",
              },
            ],
          },
          12: {
            cells: [
              {
                text: "PV (FCFF)",
              },
              {
                text: "",
              },
              {
                text: "=C8*C12",
              },
              {
                text: "=D8*D12",
              },
              {
                text: "=E8*E12",
              },
              {
                text: "=F8*F12",
              },
              {
                text: "=G8*G12",
              },
              {
                text: "=H8*H12",
              },
              {
                text: "=I8*I12",
              },
              {
                text: "=J8*J12",
              },
              {
                text: "=K8*K12",
              },
              {
                text: "=L8*L12",
              },
              {
                text: "",
              },
            ],
          },
          13: {
            cells: [
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
              {
                text: "",
              },
            ],
          },
          14: {
            cells: [
              {
                text: "Sales to Capital Ratio",
              },
              {
                text: "",
              },
              {
                text: "=2",
              },
              {
                text: "=C15",
              },
              {
                text: "=D15",
              },
              {
                text: "=E15",
              },
              {
                text: "=F15",
              },
              {
                text: "=G15",
              },
              {
                text: "=H15",
              },
              {
                text: "=I15",
              },
              {
                text: "=J15",
              },
              {
                text: "=K15",
              },
              {
                text: "",
              },
            ],
          },
          15: {
            cells: [
              {
                text: "Invested Capital",
              },
              {
                text: "=22",
              },
              {
                text: "=B16+C7",
              },
              {
                text: "=C16+D7",
              },
              {
                text: "=D16+E7",
              },
              {
                text: "=E16+F7",
              },
              {
                text: "=F16+G7",
              },
              {
                text: "=G16+H7",
              },
              {
                text: "=H16+I7",
              },
              {
                text: "=I16+J7",
              },
              {
                text: "=J16+K7",
              },
              {
                text: "=K16+L7",
              },
              {
                text: "",
              },
            ],
          },
          16: {
            cells: [
              {
                text: "ROIC",
              },
              {
                text: "=B6/B16",
              },
              {
                text: "=C6/C16",
              },
              {
                text: "=D6/D16",
              },
              {
                text: "=E6/E16",
              },
              {
                text: "=F6/F16",
              },
              {
                text: "=G6/G16",
              },
              {
                text: "=H6/H16",
              },
              {
                text: "=I6/I16",
              },
              {
                text: "=J6/J16",
              },
              {
                text: "=K6/K16",
              },
              {
                text: "=L6/L16",
              },
              {
                text: "=L11",
              },
            ],
          },
        };
        // x_spreadsheet.locale('zh-cn');
        var xs = x_spreadsheet("#x-spreadsheet-demo", {
          showToolbar: true,
          showGrid: true,
        })
          .loadData([
            {
              rows,
            },
            { name: "sheet-test", rows: rows10 },
          ])
          .change((cdata) => {
            // console.log(cdata);
            console.log(">>>", xs.getData());
          });

        xs.on("cell-selected", (cell, ri, ci) => {
          console.log("cell:", cell, ", ri:", ri, ", ci:", ci);
        }).on("cell-edited", (text, ri, ci) => {
          console.log("text:", text, ", ri: ", ri, ", ci:", ci);
        });
      }
    </script>
    <!--script type="text/javascript" src="https://unpkg.com/x-data-spreadsheet@1.0.20/dist/locale/zh-cn.js"></script-->
  </body>
</html>
